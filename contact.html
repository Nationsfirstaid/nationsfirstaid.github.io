<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Contact – Nations First Aid</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <div class="center">
    <img class="watermark" src="logos/RedPNG_76c2cae5-c477-4636-b41a-881bb9e091a5.png" alt="Red Watermark" />
    <img class="logo" src="logos/White_PNG_74dcf535-3999-4f0a-b1fa-bbcebd79a35c.png" alt="Nations First Aid Logo" />
    <div class="site-name">NATIONS FIRST AID</div>

    <div class="nav-btns">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="courses.html">Courses</a>
      <a href="register.html">Register</a>
      <a href="contact.html" class="active">Contact</a>
    </div>

    <main style="max-width: 500px; margin: 0 auto; background: rgba(255,255,255,0.04); border-radius: 12px; padding: 28px 16px 20px 16px;">
      <h2 style="color:#fff; text-align:center; margin-bottom: 16px;">Contact</h2>

      <!-- Email Verification Section -->
      <div id="email-auth-section">
        <label for="auth-email">Enter your Email Address</label><br>
        <input type="email" id="auth-email" style="width:100%;padding:8px;" required><br><br>
        <button id="send-link-btn" type="button" style="width:100%;padding:10px;">Get Link to Send Message</button>
        <p id="email-message" style="color:#fff; margin-top:10px;"></p>
      </div>

      <!-- Contact Form -->
      <form id="contactForm" action="https://formsubmit.co/nationsfirstaid@mail.com" method="POST" style="display:none;">
        <input type="hidden" name="_captcha" value="false">

        <label for="name">Full Name</label><br>
        <input type="text" id="name" name="name" required style="width:100%;padding:8px;"><br><br>

        <label for="email">Email Address</label><br>
        <input type="email" id="email" name="email" required style="width:100%;padding:8px;"><br><br>

        <label for="message">Message</label><br>
        <textarea id="message" name="message" rows="3" style="width:100%;padding:8px;"></textarea><br><br>

        <button type="submit" class="cta" style="width:100%;padding:12px 0;font-size:1.1rem;">Send Message</button>
      </form>

      <br>
      <div style="margin: 18px 0 0 0; color:#fff; text-align:center; font-size:1.09rem;">
        Email: <a href="mailto:nationsfirstaid@mail.com" style="color:#fff;text-decoration:underline;">nationsfirstaid@mail.com</a><br>
        Phone: 587-599-9355
      </div>

      <div id="success-msg" style="color:lightgreen; display:none; margin-top: 20px; text-align:center;"></div>
    </main>
  </div>

  <footer>
    <div class="disclaimer">
      &copy; 2025 Nations First Aid. All rights reserved.<br>
      All images, logos, and illustrations on this site are the exclusive property of Nations First Aid and its creator.<br>
      Unauthorized reproduction, distribution, or commercial use is strictly prohibited. Use of Indigenous imagery and symbols is with respect for cultural significance and community tradition.
    </div>
  </footer>

  <script>
    const SUPABASE_URL = "https://hhylteexskvugbwrrlkb.supabase.co"; // ✅ Replace with your real Supabase project URL if different
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhoeWx0ZWV4c2t2dWdid3JybGtiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA2NDE3MjUsImV4cCI6MjA2NjIxNzcyNX0.9PBu4UPi49jQEkc78SGMp5SaMDX_K575DRnUCR0H5pk";
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    document.addEventListener("DOMContentLoaded", async () => {
      const { data: { session } } = await supabase.auth.getSession();

      if (session) {
        document.getElementById("email-auth-section").style.display = "none";
        document.getElementById("contactForm").style.display = "block";
        document.getElementById("success-msg").innerText = "✅ Verified! You can now send a message.";
        document.getElementById("success-msg").style.display = "block";
        document.getElementById("email").value = session.user.email;
      }

      document.getElementById("send-link-btn").addEventListener("click", async () => {
        const email = document.getElementById("auth-email").value;
        if (!email) return alert("Please enter your email.");

        const { error } = await supabase.auth.signInWithOtp({
          email,
          options: {
            emailRedirectTo: "https://nationsfirstaid.com/contact.html"
          }
        });

        if (error) {
          document.getElementById("email-message").innerText = "Error: " + error.message;
        } else {
          document.getElementById("email-message").innerText = "✅ Check your inbox to confirm.";
          window.localStorage.setItem("emailForSignIn", email);
        }
      });
    });
  </script>
</body>
</html>
